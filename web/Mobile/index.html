<!DOCTYPE html> 
<html><head> 
        <title>My Page</title> 
        <meta name="viewport" content="initial-scale=1.0">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
<!--        <link rel="stylesheet" href="http://jsp.chaninz.com/tasm/Mobile/css/jquery.mobile-1.4.2.css" />-->
        <link rel="stylesheet" href="css/jquery.mobile-1.4.2.css"/>
        <link rel="stylesheet" href="css/font-awesome.min.css"/>
        <link rel="stylesheet" href="css/notiCSS.css"/>
<!--        <link rel="stylesheet" href="http://jsp.chaninz.com/tasm/Mobile/css/font-awesome.min.css"/>
        <link rel="stylesheet" href="http://jsp.chaninz.com/tasm/Mobile/css/notiCSS.css"/>-->

        <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>
    </head> 
    <body>
        <div data-role="page" class="jqm-demos ui-responsive-panel"  data-title="Panel fixed positioning" >
            <div data-role="header" data-position="fixed">
                <center>
                    <a href="index.html" rel="external" and data-ajax="false">
                        <span class="fa fa-home fa-2x" style="alignment-adjust:auto;padding-right:25px;padding-top:15px;padding-bottom:15px"></span>
                    </a>
                    <span id="notificationLink" class="fa fa-globe fa-2x"></span></center>
                    
                <div id="notificationContainer" style="margin: auto">
                    <div id="notificationTitle">Notifications</div>
                    <div id="notificationsBody" class="notifications">
                        <div style="margin: auto;border: 1px">You have new Assignment</div>
                        <div style="margin: auto;border: 1px">You have new Assignment</div>
                        <div style="margin: auto;border: 1px">You have new Assignment</div>
                        <div style="margin: auto;border: 1px">You have new Assignment</div>
                    </div>
                    <div id="notificationFooter"><a href="#">See All</a></div>
                </div>
                
                <a href="#nav-panel"><i class="fa fa-bars fa-2x"></i></a>
                <div style="padding: 5px;width: auto;background: #E2E2E2;">
                    <input type="search" name="search" id="filter" placeholder="Filter..."/>

                </div>
            </div><!-- /header -->

            <div id="add-test"></div>

            <div data-role="panel" data-position-fixed="true" data-display="overlay"  id="nav-panel">
                <ul data-role="listview" id="lcList">
                    <li style="background-color:#00F">
                        <img src="" id ="dPIC" width="100" height="100" style="alignment-adjust:top"/>&nbsp;
                        <b style="color:white" id="fName"></b><br/>
                        <b style="color:white" id="lName"></b>
                    </li>
                    <li>
                        <a href="JoinCourse.html" rel="external" and data-ajax="false">Join Course &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <div class="fa fa-plus fa-2x"></div>
                        </a>
                    </li>
                </ul>
            </div>

            <div data-position="fixed" data-tap-toggle="false" data-role="footer" data-tap-toggle="false" >
                <div data-role="navbar">
                    <ul>
                        <li><a href="index.html" rel="external" and data-ajax="false" class="ui-btn-active"><i class="fa fa-newspaper-o fa-2x"></i></a></li>
                        <li><a href="Assignment.html" rel="external" and data-ajax="false" ><i class="fa fa-file-text fa-2x"></i></a></li></ul>
                </div>
            </div>


        </div>

    </body>


    <script type="text/javascript">
        $(function () {
            var id = sessionStorage.getItem('accID');
            $.getJSON('http://localhost:8084/TheAssignment/showAnnounceStudent?id=' + id, function (result) {
                var i = 1;
                $(result).each(function (k, v) {
                    $(
                            '<div class="am" style="background-color:#' + (i % 2 == 0 ? 'FFFFFF' : 'F4F4F4') + ' ;padding:1px;width:auto;">' +
                            '<div style="margin-left:15px">' +
                            '<h4>' + v.an_acc.firstname + ' ' + v.an_acc.lastname + ' : ' + v.course_name + '</h4> ' +
                            '<p>' + v.announce_date + '</p>' +
//                            '<p>' +  v.an_acc.firstname + ' ' + v.an_acc.lastname + '</p>' +
                            '<p>' + v.content + '</p>' +
                            '</div>' +
                            '</div>').insertBefore($('#add-test'));
                    i += 1;
                });
            });
//            NAVBAR();cList[key].course.course_id
            //assignValue();
            var fName = sessionStorage.getItem('fName');
            var lName = sessionStorage.getItem('lName');
            var pic = sessionStorage.getItem('pic');
            var cList = JSON.parse(sessionStorage.getItem('cList'));
            console.dir(cList);
            $("#dPIC").attr("src", "../" + pic);
            $("#fName").text(fName);
            $("#lName").text(lName);
            var key, count = 0;
            for (key in cList) {
                if (cList.hasOwnProperty(key)) {
//                    $("#sCourse").attr(cList[key].course.course_id);
//                    $("#cName").text(cList[key].course.name);
//                     alert(key + " -> " + cList[key].course.name);
                    $("#lcList").append('<li class="cLink" data-id="' + key + '"><a class="ui-btn ui-btn-icon-right ui-icon-carat-r">' + cList[key].course.name + '</a></li>').trigger('refresh');
                }
                $(".cLink").click(function () {
                    sessionStorage.setItem('cID', $(this).attr("data-id"));
                    $(location).attr('href', 'AssignmentInCourse.html');
                });
            }
            $("#lcList").append('<li class="logOut"><a href="#" class="ui-btn ui-btn-icon-right ui-icon-carat-r">Log Out <div style="padding-left:50px" class="fa fa-power-off fa-2x"></div> </a></li>');
            $(".logOut").click(function () {
                sessionStorage.clear();
                $(location).attr('href', 'Home.html');
            });
            
            //filter
            $("#filter").keyup(function(){
               $(".am").show();
               var keyword = $(this).val();
               $(".am").each(function(){
                   var text = $(this).text();
                   if(text.indexOf(keyword) == -1){
                       $(this).hide();
                   }
               });
            });
            
//            var eventSource = new EventSource("http://jsp.chaninz.com/tasm/getNotificationMobile");
//            eventSource.addEventListener('notificationsBody', function(event) {
//            console.log(event.data);
//            if (event.data == 0) {
//                $("#notificationsBody").addClass("hide");
//            } else {
//                $("#notificationsBody").text(event.data).removeClass("hide");
//            }
//            
//            eventSource.addEventListener('notificationsBody', function(event) {
//            console.log(event.data);
//            $('.bottom-left').notify({
//                message: {text: event.data + ' New Announcement '},
//                type: 'info'
//            }).show();
//          }, false);
//           }, false);
            
        });

//        function findCourseName(course_id) {
//
//            var name = "";
//            $.ajax({
//                type: "POST",
////                url: "http://jsp.chaninz.com/tasm/getCourseName",
//                url: "http://localhost:8084/TheAssignment/getCourseName",
//                data: {"course_id": course_id},
//                async: false,
//                success: function (data) {
//                    name = data.name;
//                }
//            });
//            return name;
//        }

//        $(document).ready(function (){
//            $("#notificationLink").click(function (){
//                $("#notificationContainer").fadeToggle(300);
//                $("#notification_count").fadeOut("slow");
//                return false;
//            });
//
////Document Click hiding the popup 
//            $(document).click(function (){
//                $("#notificationContainer").hide();
//            });
//
////Popup on click
//            $("#notificationContainer").click(function (){
//                return false;
//            });

//        });

    </script>
</html>
